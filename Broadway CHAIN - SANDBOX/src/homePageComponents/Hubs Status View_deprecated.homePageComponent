<?xml version="1.0" encoding="UTF-8"?>
<HomePageComponent xmlns="http://soap.sforce.com/2006/04/metadata">
    <body>&lt;div id=&quot;hubStatus&quot;&gt;&lt;/div&gt;&lt;script src=&quot;/soap/ajax/19.0/connection.js&quot; type=&quot;text/javascript&quot;&gt; &lt;/script&gt;&amp;nbsp;&lt;script src=&quot;/soap/ajax/15.0/apex.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot;&gt;	sforce.connection.sessionId = ApiUtils.getSessionId();	var user= sforce.connection.getUserInfo();  var profileName = sforce.apex.execute(&quot;HubsController2&quot;,&quot;getProfileName&quot;, {});  var queryResult2= sforce.connection.query(&quot;select Hub_Name__c, Hub_Open__c from Hubs__c where Profile__c=&quot;+&quot;&apos;&quot; + profileName + &quot;&apos;&quot;);  	var records2 = queryResult2.getArray(&quot;records&quot;);	for (var i=0; i&lt;records2.length; i++) {	 var record = records2[i]; var sMsg = &apos;&apos;;	 if (record.Hub_Open__c == &apos;true&apos;){	 sMsg = &apos;The &apos; + record.Hub_Name__c + &apos; is currently open&apos;;	 } else{var queryResult3= sforce.connection.query(&quot;select Reason_for_close__c, Change_time__c from Hub_Status_Audit__c where Hub_Name__c = &quot; + &quot;&apos;&quot; + record.Hub_Name__c + &quot;&apos;&quot; + &quot; and Status__c = &apos;Closed&apos; order by Hub_name__c desc limit 1&quot;); var records3 = queryResult3.getArray(&quot;records&quot;);	 sMsg = &apos;The &apos; + record.Hub_Name__c + &apos; is not currently open&apos;;	 } var myDiv = document.getElementById(&apos;hubStatus&apos;);	 var p = document.createElement(&apos;p&apos;);  p.innerHTML = sMsg; myDiv.appendChild(p);  	 p.setAttribute(&apos;id&apos;, &apos;text&apos; + i);	 if (record.Hub_Open__c == &apos;true&apos;){ p.setAttribute(&apos;style&apos;, &apos;color:green&apos;);	 } else {	 p.setAttribute(&apos;style&apos;, &apos;color:red&apos;);	 } } &lt;/script&gt;</body>
    <pageComponentType>htmlArea</pageComponentType>
    <width>wide</width>
</HomePageComponent>
